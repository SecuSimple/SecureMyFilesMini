!function(a){var b=function(a,b,c,d,e){var g=c,h=c,i=0,j=new a(d),k=new Array(j.keyLength/8);j.init(),k=f.stringToByteArray(b,32),j.expandKey(k),this.encrypt=function(a){for(var b,c,d,e,h=0,l=[];h<a.byteLength;){for(b=h+16,b>a.byteLength&&(b=a.byteLength),e=[],d=0,c=h;b>c;d++,c++)e[d]=a[c];for(;16>d;)e[d++]=0;for(i^=f.cksum(e),f.xor(e,g),j.encrypt(e,k),g=e.slice(0),d=0,c=l.length;16>d;d++,c++)l[c]=e[d];h+=16}return l},this.decrypt=function(a){for(var b,c,d,e=0,g=[];e<a.byteLength;){for(b=e+16,b>a.byteLength&&(b=a.byteLength),c=[],eidx=0,idx=e;idx<b;eidx++,idx++)c[eidx]=a[idx];for(d=c.slice(0),j.decrypt(c,k),f.xor(c,h),i^=f.cksum(c),h=d,eidx=0,idx=g.length;eidx<16;eidx++,idx++)g[idx]=c[eidx];e+=16}return g},this.getChecksum=function(){return f.stringToByteArray(i.toString(),16)},this.isChecksumValid=function(){return f.byteArrayToString(e)===i.toString()}},c=function(a){var b,c,d,e,f,g=function(a,b){for(var c=0;16>c;c++)a[c]^=b[c]},h=function(a,b){for(var c=0;16>c;c++)a[c]=b[a[c]]},i=function(a,b){for(var c=a.slice(0),d=0;16>d;d++)a[d]=c[b[d]]},j=function(a){for(var b=0;16>b;b+=4){var c=a[b+0],d=a[b+1],e=a[b+2],g=a[b+3],h=c^d^e^g;a[b+0]^=h^f[c^d],a[b+1]^=h^f[d^e],a[b+2]^=h^f[e^g],a[b+3]^=h^f[g^c]}},k=function(a){for(var b=0;16>b;b+=4){var c=a[b+0],d=a[b+1],e=a[b+2],g=a[b+3],h=c^d^e^g,i=f[h],j=f[f[i^c^e]]^h,k=f[f[i^d^g]]^h;a[b+0]^=j^f[c^d],a[b+1]^=k^f[d^e],a[b+2]^=j^f[e^g],a[b+3]^=k^f[g^c]}};this.algorithm="AES",this.keyLength=a?a:256,this.init=function(){b=new Array(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22),c=new Array(0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11),d=new Array(256);for(var a=0;256>a;a++)d[b[a]]=a;e=new Array(16);for(var g=0;16>g;g++)e[c[g]]=g;f=new Array(256);for(var h=0;128>h;h++)f[h]=h<<1,f[128+h]=h<<1^27},this.expandKey=function(a){var c,d=a.length,e=1;switch(d){case 16:c=176;break;case 24:c=208;break;case 32:c=240;break;default:throw"Key error: Only key lengths of 16, 24 or 32 bytes allowed!"}for(var f=d;c>f;f+=4){var g=a.slice(f-4,f);f%d===0?(g=new Array(b[g[1]]^e,b[g[2]],b[g[3]],b[g[0]]),(e<<=1)>=256&&(e^=283)):d>24&&f%d==16&&(g=new Array(b[g[0]],b[g[1]],b[g[2]],b[g[3]]));for(var h=0;4>h;h++)a[f+h]=a[f+h-d]^g[h]}},this.encrypt=function(a,d){var e=d.length;g(a,d.slice(0,16));for(var f=16;e-16>f;f+=16)h(a,b),i(a,c),j(a),g(a,d.slice(f,f+16));h(a,b),i(a,c),g(a,d.slice(f,e))},this.decrypt=function(a,b){var c=b.length;g(a,b.slice(c-16,c)),i(a,e),h(a,d);for(var f=c-32;f>=16;f-=16)g(a,b.slice(f,f+16)),k(a),i(a,e),h(a,d);g(a,b.slice(0,16))}},d={AES:c},e=function(a){var b,c=0,d=16e4,e=new FileReader,g=a.size,h=a.name,i=[],j="undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator),k="undefined"!=typeof webkitRequestFileSystem&&function(a,c){webkitRequestFileSystem(TEMPORARY,b,function(b){b.root.getDirectory("SecureMyFiles",{create:!0},function(b){var d=function(){b.getFile(c,{create:!0,exclusive:!1},function(b){b.createWriter(function(c){c.onwriteend=function(a){window.location.href=b.toURL()},c.write(a)})})};b.getFile(c,{create:!1},function(a){a.remove(d)},function(){d()})})})},l=function(a,b){var c=URL.createObjectURL(a),d=document.createElement("a");d.style="display: none",document.body.appendChild(d),d.href=c,d.download=b,d.click(),setTimeout(function(){URL.revokeObjectURL(c)},0)},m=function(b,d){if(c>=g)return!1;var f=b;return c+b>g&&(f=g-c),e.onload=function(a){if(2===e.readyState){var b=new Uint8Array(e.result);"function"==typeof d&&setTimeout(function(){d(b)},5)}},e.readAsArrayBuffer(a.slice(c,c+f)),c+=f,!0};this.readNext=function(a){return m(d,a)},this.readNextLength=function(a,b){if(!a)throw"Argument exception: Size zero or not specified.";return m(a,b)},this.store=function(a,b,c){i=b?a.concat(i):i.concat(a),"function"==typeof c&&c()},this.getLength=function(){return g},this.setLength=function(a){b=f.byteArrayToString(a)},this.getData=function(){return f.toTypedArray(i,b)},this.saveToDisk=function(){var a=j||k||l,c=new Blob([f.toTypedArray(i,b)],{type:"application/octet-stream"});h=b?h.replace(".smfw",""):h.concat(".smfw"),a(c,h)}},f={};f.cksum=function(a){for(var b=0,c=a.length,d=0;c>d;d++)b=31*b+a[d];return b},f.xor=function(a,b){for(var c=0;16>c;c++)a[c]=a[c]^b[c]},f.toTypedArray=function(a,b){for(var c=b?Math.min(a.length,b):a.length,d=new Uint8Array(c),e=c-1;e>=0;e--)d[e]=a[e];return d},f.stringToByteArray=function(a,b){if(a.length>b)throw"String is too large";for(var c=new Array(b),d=a.length-1,e=b-1;d>=0;d--,e--)c[e]=a.charCodeAt(d);for(;e>=0;)c[e--]=0;return c},f.byteArrayToString=function(a){for(var b="",c=0;c<a.byteLength;c++)0!==a[c]&&(b+=String.fromCharCode(a[c]));return b},f.RandomGenerator=function(){var a=!1,b=[],c=function(){"undefined"!=typeof document&&(!a&&b.length<=102400?(document.addEventListener("mousemove",d),a=!0):a&&b.length>102400&&(document.removeEventListener("mousemove",d),a=!1))},d=function(a){b.push(a.screenX),b.push(a.screenY),c()};this.generate=function(){for(var a,d,e,f=[],g=0;16>g;g++)for(a=b.length>1?b.splice(g,2):[10*Math.random(),10*Math.random()],d=new Date,e=2===a.length?(a[0]*Math.random()+a[1]*Math.random())/10:(10*Math.random()+100*Math.random()+1e3*Math.random())/100,f[g]=parseInt(e*d.getMilliseconds()/10);f[g]>255;)f[g]-=255;return c(),f},c()};var g=function(a,c,g,h){var i,j,k=new f.RandomGenerator;if("function"!=typeof a||"function"!=typeof c)throw"Success and Error callbacks are mandatory and must be functions!";var l=function(b){if(n(b.byteLength),b=j.encrypt(b),i.store(b),!i.readNext(l)){i.store(j.getChecksum(),!0),h&&i.saveToDisk();var c=i.getData();i=null,j=null,a(c)}},m=function(b){if(n(b.byteLength),b=j.decrypt(b),i.store(b),!i.readNext(m))if(j.isChecksumValid()){h&&i.saveToDisk();var d=i.getData();i=null,j=null,a(d)}else c(1)},n=function(a){"function"==typeof g&&g(a,i.getLength())};this.encryptFile=function(a,c){var g=k.generate();i=new e(a),j=new b(d.AES,c,g,256),i.store(f.stringToByteArray(a.size.toString(),16).concat(g)),i.readNext(l)},this.decryptFile=function(a,c){i=new e(a),i.readNextLength(48,function(a){j=new b(d.AES,c,a.subarray(32),256,a.subarray(0,16)),i.setLength(a.subarray(16,32)),i.readNext(m)})}};"undefined"!=typeof exports?exports.smf=g:"function"==typeof define&&define.amd?define("smf",[],function(){return g}):a.smf=g}(this);